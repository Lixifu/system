## 问题分析

当前系统只支持生成和管理活动签到二维码，缺少签退专用二维码功能。这导致参与者无法顺利完成签退流程，影响活动数据的完整性和参与者的服务时长统计。

## 解决方案

### 1. 后端修改

#### 1.1 修改活动模型
- 在 `backend/models/Activity.js` 中添加 `signOutQrCode` 字段，用于存储签退二维码
- 字段类型、注释等与现有 `qrCode` 字段保持一致

#### 1.2 扩展二维码生成和管理API
- 修改 `backend/routes/activities.js` 中的二维码相关路由
- 添加签退二维码的生成、获取、更新和禁用功能
- 保持与签到二维码相同的技术标准和格式规范

#### 1.3 二维码内容格式
- 签退二维码内容格式：`activity-${activity.id},signOut-${Date.now()}`
- 与签到二维码格式保持一致，仅操作类型不同

### 2. 前端修改

#### 2.1 更新二维码管理界面
- 修改 `src/js/main.js` 中的 `renderQRCodeManagement` 函数
- 添加签退二维码的显示区域
- 为签退二维码添加独立的生成、更新、下载和禁用按钮

#### 2.2 扩展二维码操作函数
- 添加 `generateSignOutQRCode` 函数，用于生成签退二维码
- 添加 `updateSignOutQRCode` 函数，用于更新签退二维码
- 添加 `downloadSignOutQRCode` 函数，用于下载签退二维码
- 添加 `disableSignOutQRCode` 函数，用于禁用签退二维码

#### 2.3 增强视觉区分
- 为签到和签退二维码添加明确的标题和说明
- 使用相同的视觉识别特征，确保系统兼容性

## 实施步骤

### 步骤1：修改活动模型
1. 打开 `backend/models/Activity.js` 文件
2. 在 `qrCode` 字段后添加 `signOutQrCode` 字段

### 步骤2：扩展后端API路由
1. 打开 `backend/routes/activities.js` 文件
2. 扩展 `get` 路由，返回签到和签退二维码
3. 添加签退二维码的生成、更新和禁用路由

### 步骤3：更新前端二维码管理界面
1. 打开 `src/js/main.js` 文件
2. 修改 `renderQRCodeManagement` 函数，添加签退二维码显示区域
3. 添加签退二维码操作按钮

### 步骤4：扩展前端操作函数
1. 添加签退二维码的生成、更新、下载和禁用函数
2. 确保这些函数与签到二维码函数保持一致的实现逻辑

### 步骤5：测试和验证
1. 重启后端服务器
2. 测试签退二维码的生成和管理功能
3. 验证扫码功能能否正确处理签退二维码

## 预期效果

- 活动组织方可以为每个活动生成独立的签到和签退二维码
- 签到和签退二维码具有相同的技术标准和格式规范
- 参与者可以使用同一扫码工具完成签退操作
- 系统能够正确处理签退请求，更新参与者的服务时长
- 二维码管理界面提供清晰的视觉区分，方便组织方管理